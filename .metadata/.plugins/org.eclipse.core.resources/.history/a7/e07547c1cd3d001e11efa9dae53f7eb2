package Principal.Telas.Gerente;

import javafx.fxml.FXML;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import Ferramentas.model.Funcionario;

public class TabelaFuncionarioController {
    @FXML
    private TableView<Funcionario> tableView;
    @FXML
    private TableColumn<Funcionario, String> nomeColumn;
    @FXML
    private TableColumn<Funcionario, String> cpfColumn;
    @FXML
    private TableColumn<Funcionario, String> telefoneColumn;
    @FXML
    private TableColumn<Funcionario, String> cargoColumn;
    @FXML
    private TableColumn<Funcionario, Double> salarioColumn;

    @FXML
    private void initialize() {
        nomeColumn.setCellValueFactory(cellData -> cellData.getValue().nomeProperty());
        cpfColumn.setCellValueFactory(cellData -> cellData.getValue().cpfProperty());
        telefoneColumn.setCellValueFactory(cellData -> cellData.getValue().telefoneProperty());
        cargoColumn.setCellValueFactory(cellData -> cellData.getValue().cargoProperty());
        salarioColumn.setCellValueFactory(cellData -> cellData.getValue().salarioProperty().asObject());

        // Carregar dados do banco de dados e preencher a TableView
        try (Connection connection = DatabaseConnection.getConnection();
             Statement statement = connection.createStatement()) {
            String query = "SELECT nome, cpf, telefone, cargo, salario FROM tabela";
            ResultSet resultSet = statement.executeQuery(query);

            List<Pessoa> pessoas = new ArrayList<>();
            while (resultSet.next()) {
                Pessoa pessoa = new Pessoa();
                pessoa.setNome(resultSet.getString("nome"));
                pessoa.setCpf(resultSet.getString("cpf"));
                pessoa.setTelefone(resultSet.getString("telefone"));
                pessoa.setCargo(resultSet.getString("cargo"));
                pessoa.setSalario(resultSet.getDouble("salario"));
                pessoas.add(pessoa);
            }

            tableView.getItems().addAll(pessoas);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
