package model.dao.login;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import model.dao.ConexãoBD;

public class loguinModel {

	
	public static Boolean ValidaLogin(String email,String senha) throws SQLException {
	
		Connection conecao = ConexãoBD.Conexao();
		

		String ComandoSql = "select *from funcionario where email=? and senha=?" ;
		
		
		
		PreparedStatement stmt = conecao.prepareStatement(ComandoSql);
		
		stmt.setString(1, email);
		stmt.setString(2, senha);
		
		ResultSet rs = stmt.executeQuery();
		
		
		
		if(rs.next()) {
			
			
			
		 String updateSql ="UPDATE sessao SET sessao = ? WHERE id = 1";
         PreparedStatement updatePs = conecao.prepareStatement(updateSql);
         updatePs.setInt(1, 1);
         
         int lf = updatePs.executeUpdate();
         
         updatePs.close();
         stmt.close();
 		conecao.close();
 		
         return true;
         
		} else { 
			
		stmt.close();
		conecao.close();
	
		return false;
		}
		
		
		
		
		
		
	}
	
	
	 public static String getCargo(String email, String senha) throws SQLException {
	        Connection conecao = ConexãoBD.Conexao();
	        
	        System.out.println("olá");

	        String ComandoSql = "SELECT cargo FROM funcionario WHERE email=? AND senha=?";
	        PreparedStatement stmt = conecao.prepareStatement(ComandoSql);

	        stmt.setString(1, email);
	        stmt.setString(2, senha);

	        ResultSet rs = stmt.executeQuery();

	        if (rs.next()) {
	            String cargo = rs.getString("cargo");
	            stmt.close();
	            conecao.close();
	            System.out.println(cargo);
	            return cargo;
	        } else {
	            stmt.close();
	            conecao.close();
		        System.out.println("olaaaaa");

	            return ""; 
	        }
	    }
	
	
	
	
	
}
